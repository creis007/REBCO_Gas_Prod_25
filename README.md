# REBCO_Gas_Prod_25
Repository for Journal of Applied Physics Manuscript #JAP25-AR-00635 titled "Irradiation-induced gas production in REBCO-based magnet materials used for future compact fusion reactors" in accordance with JAP's Openness Initiative and Data Availabilty. 

About:
At its core this project looks takes raw neutron spectral data and outputs several key transmutation metrics. This is adapted specifically for transmuation effects on REBCO high-temperature superconductors used in compact fusion reactor architectures and would be useful to fusion engineers but also High-Energy Physics accelerator magnet engineers. Please see the manuscript/paper for a full discussion of the broader implications of this study. 

Full Chain of Computational Components:
1) Simulated neutron 'primary' spectra (Monte Carlo)
2) Simulated ion 'secondary' spectra (TALYS)
3) Simulated ion ranges (SRIM/Elast)
4) Calculated gas production fluences/densities in the REBCO layer for single flux bin (Excel)
5) Calculated gas production for entire spectra in the hastelloy substrate and copper stabilizer (Excel, Revision Update)
6) Plotting (MATLAB)

Note that this study was based on other studies which completed the computationally taxing 1st component, referenced in the manuscript. Moreover, the 2nd component TALYS (a nuclear reaction program) and 3rd component SRIM (Stopping and Range of Ions in Matter) are publically availaible online for free at https://github.com/arjankoning1/talys and http://www.srim.org/ respectively. Therefore this repository contains raw text data files from these three but not the Monte Carlo(eg. MCNP), TALYS, or SRIM code packages themselves. In adition to the text data, this repository contains the Excel sheet we used to calculate ion production rates in the superconducting layer.


Computational Flow:

Pre Steps: Use Monte Carlo neutron trasnport code to assess neutron spectrum impinging material of interest based on desired reactor/beam geometry. Next take raw spectrum and input into TALYS to estimate secondary ion spectra of interest. As mentioned before, in the case of this study we took the neutron spectrum simulated at the REBCO location in an ARC-like reactor and input into TALYS to get secondary ion spectra. An example of the Monte Carlo data file is uploaded "spectrum360_A_JENDL_PHITS". Other examples of raw spectral data are pasted directly onto the Excel sheet, as detailed below. 

The Excel Sheets.
To preproduce our results, download the Excel sheet and follow the next steps. Be warned the sheet is not very pretty, lots of copied and pasted stuff all over but it has been cleaned up as best as possible and is adequate for attaining results upon closely following instructions. The Excel document is comprised of four sheets: sheet 1 "ARC_BR2_spectra_Lee", sheet 2 "elast stopping in Ni", sheet 3 "Alpha Spec", and sheet 4 "Proton Spec". 

Step one: Raw Flux Input
Sheet 1 contains some other spectral data but very importantly the raw flux at the neutron energy we wish to investigate in cell D16. This was pasted straight from the aforementioned raw Monte Carlo data file. The user may replace this with any flux they want, for our purposes we chose the worst-case unshielded flux. Note that the proper units are neutrons per square centimetre per second.

Step two: Ion Range Trends
Sheet 2 is comprised of three main parts: the alpha stopping block on the left, the proton stopping block on the right and the plots beneath both blocks. Both blocks show the energies we used is inputs in columns A (0-20 MeV) and how through a series of simulations the iop stopping code, provide the range that these ions would have in that material, in column I. This was done to find the trend in ion range as a function of incoming energy, which is what is ploted beneath. A polynomial fit of these graphs provided an equation for the energy-range relation need for the next step.

Step three: Ion Ranges based on Secondary Spectra
Sheet 3 and 4 work identically, and the process for each isotope, in this example Excel sheet nickel 58 (columns G-L) and nickel 60 (columns N-S), works identically. With our trends developed, we can now estimate how far ions produced from transmutation reactions travel after they are created. Let us narrow our focus to ni58, starting with column G, and work rightwards. The raw secondary ion spectra are produced by TALYS and is pasted in columns G,H: in column G the energy of the ion after being produced by transmutation, and in column H the cross section per unit energy (mb/MeV). In column I we use the range relation to then find out how far each ion can travel in nickel after it is born. Here is where understanding the descritization into thin slices becomes key. For each consecutive energy that we use (choosen as 0.1 MeV arbirtarily but keeping in mind we are balancing fidelity with computational effort) we have a corresponding range. Column J is used to calculate the number density of atoms in between, say, the i and the i+1 range in order to set up the target number density needed for the first principles Reaction Rate equation (R= N*sig*phi), calculated then in column K. Columns L, S, U, and V were constructed for plotting purposes and are not fundamental to this caluclation.

Step four: Tallying the Ions produced in each slice
We conclude with columns A-E. The Hastelloy (approximated to pure nickel) layer is discretized into 50 2-micron slices that we may visualize adjacent to the REBCO layer, visualized in manuscript figure 3 and represented in column A. Column B for ni58 (and C for ni60) uses excel's Vlookup function to search the ranges prediced in column J and find the flux of ions that travels a range corresponding to the slice thickness. For example, column A4 is the slice 4 microns away from the REBCO layer. The Vlookup function of column B checks all the ranges that are near 4 microns, which by eye can be seen as column I23 as 3.89 microns, and takes the flux that corresponds to it, 3.91E-8 in K23, and places it in B4. In this way, all the ion fluxes with the exact range that results in depositing into the supercondutcing layer is obtained. These are summed in column D, in flux units of ions/cm^2/s, which are then multiplied by the number of seconds in time-spans on the order of fission reactor lifetimes (10 and 30 years).

Step five: Total Fluences and Atomic/Parts-per-Million Densities in the REBCO layer for a single neutron flux bin 
Row 28, column D, E, and F sum the total superconducting layer ion implantation flux, 10 year fluence, and 30 year fluence, respectively. Row, 30 uses the density of REBCO (row 29) in the layer to then find the atomic density in ppm, shown for 10 years in column E, and 30 years in column F. 

------REVISION UPDATE----------
During the 1st round of revisions to the manuscript the authors had the opportunity to add other cross sections besided the pure 14 MeV spectrum. These follow-up steps are:

Step six: Hydrogen and helium densities in the hastelloy and stabilizer layers
Two additional excel sheets are now employed, "Ni-spectrum360_A_JENDL_PHITS" and "Cu-spectrum360_A_JENDL_PHITS". For this step the sheets are identical: Sheet one has the main calculations and sheet two the cross sections. The plot is just the neutron spectrum raw data. We begin on sheet one, COL. E-J. Bin size unclear so use average to get bin size. Otherwise we donâ€™t know how many neutrons are in between two differnet energies on the x-axis which vary incredibly across the spectrum. COL. L-S check if the energies mactch the minimum energies of the cross sections provided by ENDF (sheet2), and if they do it pulls them on to this sheeet. In other words these are all raw cross sections. Units cm^2. COL. T-W finds the areal reaction rate  exactly the same way we find volumetric RR except it uses a depth rather than a volume. RR=N*flux*xsec so the leading terms {[density of element (g/cm3)]/[molar mass of element (g/mol)]}(isotopic abundance [unitless])(Avagadros[atoms/mol]) get you N in atoms/cm3. Note he mixed up isotpes, 60 is 58 and 58 is 60. The next term (Hastelloy thickness[cm]) takes N and gives us the number of atoms in a cross section rather than a volume. Then the flux is factored then the sum of the cross sections and you finally get RR as (prod./cm2/s) which you can multiply by a cros section to complete a "volume" that gives you total number of particles. Finaly in COL. A-B he multiplies by seconds to get particles/cm^2 total areal fluence then divides by standard areal density of element, leaving you with (prod./atoms) which is multipled by 10^6 to get ppm. 

Step seven: scaling laws to find new ppm in the REBCO layer
With the time constraint of the resubmission were not able to apply the methodology of the slices to every single neutron energy bin so we took ratios to ascertain the fluences/densities. In both sheets this is handled in COL. A-D but the Ni sheet has the additional summing between both sheets. Note first that if there seems to be a disparity in ppm between sheets it is because the original sheet assess the ppm in the REBCO layer but the new sheets do so in the nickel and copper (different molar mass, density, so diff atomic ppm). First we start with the estimated 14 MeV fluxes from the old sheet and see how it compares with all the new neutron buckets. We decieded to first try 10-14 MeV then add 7-10 MeV. The reason we did not do all at once is becuase as we begin to stray from 14 MeV, the recoil peak for the secondaries also decreases, which means the recoil data does stops being approipriate. Moreover, the cross sectiion begins to change, so we kept it above 7 since the (n,a) xsec between 7-14 only varies from 0.8 to 1.2 barns (as seen on sheet two). Under the assumption that 10-14 MeV would all roughly have similar secondary recoils we took the ratio of the total 14 MeV flux with the 1st sheet's 14 MeV fluxes that get into the REBCO layer to get a proportionality factor. We saw that it made sense (it was only 1-2%) and aplied the ratio to 10-14 MeV flux bins and saw that we would still come up short. We repeated the process for 7-10 MeV using the same proportionality factor under our assumption of similar xsec the scaled what we got by the rate of decline of the polynomial we derived on the old sheet related recoil as a funciton of distance. This roughly (but not perfectly!) accounts for the shift in the peak. These two are then summed to find the fluxes ad densities. The same was done on sheet two for copper excet we had to take into account the 15x2 um slices instead of nickel's 25. Finally, on the Nickel sheet, the He and H values from both sheets are summed to get the 30 yr lifetime fluences/densities. 


Step eight: Plots
The raw data was treated in excel and plotted in MATLAB. The source/working folder for all of our figures have been uploaded as well in a separate folder. 


